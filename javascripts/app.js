"undefined"==typeof JST&&(JST={}),JST.artist=function(t){t||(t={}),null==window.__reactTagCount&&(window.__reactTagCount=0);var e,n=[],r=t.safe,s=t.escape;return e=t.safe=function(t){if(t&&t.ecoSafe)return t;("undefined"==typeof t||null==t)&&(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){n.push('<header>\n  <h2><a href="/">&laquo; butter?</a></h2>\n</header>\n<div id="artist_detail">\n</div>\n<div id="album_list">\n  <div id="loading">\n    <img src="/721.GIF" />\n  </div>\n</div>')}).call(this)}.call(t),t.safe=r,t.escape=s,n.join("")},"undefined"==typeof JST&&(JST={}),JST.artist_detail=function(t){t||(t={}),null==window.__reactTagCount&&(window.__reactTagCount=0);var e,n=[],r=function(t){return t&&t.ecoSafe?t:"undefined"!=typeof t&&null!=t?a(t):""},s=t.safe,a=t.escape;return e=t.safe=function(t){if(t&&t.ecoSafe)return t;("undefined"==typeof t||null==t)&&(t="");var e=new String(t);return e.ecoSafe=!0,e},a||(a=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t;n.push("<div>\n<h1>"),n.push(r(this.artist.name)),n.push("</h1>\n<h2>"),null!=(null!=(t=this.artist.area)?t.name:void 0)&&(n.push(" "),n.push(r(this.artist.area.name)),n.push(", "),n.push(r(this.artist["life-span"].begin)),n.push(" - "),n.push(r(this.artist["life-span"].end))),n.push("</h2>\n</div>")}).call(this)}.call(t),t.safe=s,t.escape=a,n.join("")},"undefined"==typeof JST&&(JST={}),JST.artist_works=function(t){t||(t={}),null==window.__reactTagCount&&(window.__reactTagCount=0);var e,n=[],r=function(t){return t&&t.ecoSafe?t:"undefined"!=typeof t&&null!=t?a(t):""},s=t.safe,a=t.escape;return e=t.safe=function(t){if(t&&t.ecoSafe)return t;("undefined"==typeof t||null==t)&&(t="");var e=new String(t);return e.ecoSafe=!0,e},a||(a=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,s,a,u,i,o,l;for(n.push("<div>\n  "),o=this.albums,s=0,u=o.length;u>s;s++){for(t=o[s],n.push('\n    <a class="album" href="'),n.push(r(t.external_urls.spotify)),n.push('" target="_blank">\n\n      <div class="inneralbum">\n        <img src="" style="background-image: url(\''),n.push(r(t.images.length>0?t.images[0].url:"http://i.dailymail.co.uk/i/pix/2010/08/27/article-1306599-0AEC3259000005DC-640_634x469.jpg")),n.push("')\" />\n        <h2>"),n.push(r(t.name)),n.push('</h2>\n      </div>\n<!-- \n      <div class="albumartists">\n        <p>\n          '),l=t.artists,a=0,i=l.length;i>a;a++)e=l[a],n.push("\n            <span>"),n.push(r(e.name)),n.push("</span>\n          ");n.push("\n          - "),n.push(r(t.release_date.slice(0,4))),n.push('\n        </p>\n      </div> -->\n      <!-- <iframe src="https://embed.spotify.com/?uri='),n.push(r(t.uri)),n.push('" width="640" height="80" frameborder="0" allowtransparency="true"></iframe> -->\n      <!-- '),n.push(r(JSON.stringify(t.stats))),n.push(" -->\n    </a>\n  ")}n.push("\n</div>")}).call(this)}.call(t),t.safe=s,t.escape=a,n.join("")},"undefined"==typeof JST&&(JST={}),JST.form=function(t){t||(t={}),null==window.__reactTagCount&&(window.__reactTagCount=0);var e,n=[],r=t.safe,s=t.escape;return e=t.safe=function(t){if(t&&t.ecoSafe)return t;("undefined"==typeof t||null==t)&&(t="");var e=new String(t);return e.ecoSafe=!0,e},s||(s=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){n.push('<header>\n  <h1>Butter!</h1>\n\n  <div class="form">\n    <input autocomplete="off" placeholder="Enter an artist or composer..." type="text" id="query" value="" class="form-control" />\n  </div>\n</header>\n\n<div id="results">\n\n</div>')}).call(this)}.call(t),t.safe=r,t.escape=s,n.join("")},"undefined"==typeof JST&&(JST={}),JST.form_results=function(t){t||(t={}),null==window.__reactTagCount&&(window.__reactTagCount=0);var e,n=[],r=function(t){return t&&t.ecoSafe?t:"undefined"!=typeof t&&null!=t?a(t):""},s=t.safe,a=t.escape;return e=t.safe=function(t){if(t&&t.ecoSafe)return t;("undefined"==typeof t||null==t)&&(t="");var e=new String(t);return e.ecoSafe=!0,e},a||(a=t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var t,e,s,a;for(n.push('<div id="artist_results">\n  '),a=this.artists,e=0,s=a.length;s>e;e++)t=a[e],n.push('\n    <a class="artisti" href="/compoz0r/'),n.push(r(t.id)),n.push('">\n      <img src="'),n.push(r(t.images.length>0?t.images[0].url:"http://i.dailymail.co.uk/i/pix/2010/08/27/article-1306599-0AEC3259000005DC-640_634x469.jpg")),n.push('" /><span>'),n.push(r(t.name)),n.push("</span>\n    </a>\n  ");n.push("\n</div>")}).call(this)}.call(t),t.safe=s,t.escape=a,n.join("")};var Router,_ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Router=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.routes={"(/)":"home","compoz0r/:id(/)":"comp"},e.prototype.home=function(){return H.app.home()},e.prototype.comp=function(t){return H.app.composer(t)},e}(Backbone.Router);var Bargh;Bargh=function(){function t(){}return t.prototype.el="#container",t.prototype.r=null,t.prototype.home=function(){return this.initEvents(),this.renderSearch(),$("#loading").hide()},t.prototype.renderSearch=function(){return $(this.el).html(JST.form())},t.prototype.searchArtist=function(t){return null!=this.r&&this.r.abort(),this.r=$.ajax({url:"https://api.spotify.com/v1/search",data:{q:t,limit:20,type:"artist"},success:function(t){return console.log(t.artists),$("#results").html(JST.form_results({artists:t.artists.items}))}})},t.prototype.initEvents=function(){var t=this;return $("body").on("keyup change","#query",function(e){nop(e),t.searchArtist($("#query")[0].value)})},t.prototype.composer=function(t){return this.renderArtist(),this.fetch(t),this.results=[],this.albums=[]},t.prototype.renderArtist=function(){return $("#container").html(JST.artist()),$("#container").on("mouseover",".inneralbum img",function(t){return t.currentTarget.src="http://www.clker.com/cliparts/j/W/O/s/N/o/windows-media-player-play-button-md.png"}),$("#container").on("mouseout",".inneralbum img",function(t){return t.currentTarget.src=""}),$("#loading").show()},t.prototype.fetch=function(t){var e=this;return $.ajax({url:"https://api.spotify.com/v1/artists/"+t,success:function(t){return $("#artist_detail").html(JST.artist_detail({artist:t}))}}),$.ajax({url:"https://api.spotify.com/v1/artists/"+t+"/albums",data:{album_type:"album",market:"US"},success:function(t){return e.handleAlbums(t)}})},t.prototype.handleAlbums=function(t){return null!=t.next?(this.results=this.results.concat(_.map(t.items,function(t){return t.id})),this.fetchNext(t.next)):(console.log("Nope"),this.results=_.uniq(this.results),0===this.results.length?$("#album_list").html("<h1 style='margin-left: 40px;'>No results found :(</h1>"):this.fetchAlbumData())},t.prototype.fetchNext=function(t){var e=this;return $.ajax({url:t,success:function(t){return e.handleAlbums(t)}})},t.prototype.fetchAlbumData=function(){var t,e,n,r,s,a,u=this;for(console.log(this.results),n=0,a=[],e=r=0,s=this.results.length;s>r;e=r+=20)t=this.results.slice(e,e+20),a.push($.ajax({url:"https://api.spotify.com/v1/albums",data:{ids:t.join(",")},success:function(t){return console.log(t.albums),u.albums=u.albums.concat(t.albums),n+=20,n>=u.results.length?(console.log("CLA"),u.calculatez()):void 0}}));return a},t.prototype.calculatez=function(){var t,e,n,r,s,a,u,i,o,l,c;for(l=this.albums,a=0,i=l.length;i>a;a++){for(t=l[a],t.stats={},t.stats.artist_count=1-t.artists.length/10,t.stats.popularity=t.popularity/10,r=moment().unix(),n=moment(t.release_date).unix(),t.stats.age=2*(r-n)/r,e=[],c=t.tracks.items,u=0,o=c.length;o>u;u++)s=c[u],e=e.concat(s.artists);t.stats.track_artist_count=1-_.uniq(e,function(t){return t.id}).length/10,t.stats.sum=t.stats.artist_count+t.stats.age+t.stats.track_artist_count}return this.albums=_.sortBy(this.albums,function(t){return-t.stats.sum}),this.renderAlbums()},t.prototype.renderAlbums=function(){return $("#loading").hide(),$("#album_list").html(JST.artist_works({albums:this.albums}))},t}(),window.H={Models:{},Collections:{},Views:{},Routers:{},init:function(){return console.debug("Routerz"),this.router=new Router,this.app=new Bargh,Backbone.history.start({pushState:!0,hashChange:!1})}},$(document).ready(function(){return H.init()}),window.nop=function(t){return t.preventDefault()};